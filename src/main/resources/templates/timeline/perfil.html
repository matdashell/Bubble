<!DOCTYPE html>
<html lang="pt" xmlns:th="https://www.thymeleaf.org">
    <head th:replace="replace/base :: css"></head>
    <body>
        <header th:replace="replace/base :: navbar"></header>
        <main>
            <div th:replace="replace/base :: alert"></div>
            <div class="container card">
                <div class="col-xs-12">
                    <ul class="nav nav-pills nav-pills-icons" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active show" href="#sobre" role="tab" data-toggle="tab" aria-selected="true">
                                <i class="material-icons">account_circle</i>
                                Sobre
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#pref" role="tab" data-toggle="tab" aria-selected="false">
                                <i class="material-icons">psychology</i>
                                Preferências
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#bubble" role="tab" data-toggle="tab" aria-selected="false">
                                <i class="material-icons">public</i>
                                Bubble's
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content tab-space">

                        <!--informações sobre usuario-->
                        <div class="tab-pane active show container row" id="sobre">

                            <!--opções internas perfil usuairo-->
                            <div class="card card-nav-tabs card-plain">
                                <div class="card-header card-header-info">

                                    <div class="nav-tabs-navigation">
                                        <div class="nav-tabs-wrapper">
                                            <ul class="nav nav-tabs" data-tabs="tabs">
                                                <li class="nav-item">
                                                    <a class="nav-link active" href="#home2" data-toggle="tab">Home</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="#posts2" data-toggle="tab">Posts</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="#amigos2" data-toggle="tab">Conexões</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body ">
                                    <div class="tab-content text-center">

                                        <!--nav primaria-->
                                        <div class="tab-pane active" id="home2">

                                            <!--avatar-->
                                            <div class="container row">
                                                <div class="col-5 container-img margin-top-1 mx-auto">
                                                    <img th:src="${'/provedor/nickImg/' + usuario.getUsername}" alt="Image"
                                                         class="img-raised rounded-circle" style="max-width: 20em;">
                                                </div>
                                                <!--informações/ interações-->
                                                <div th:fragment="panel" class="col-7 mx-auto">
                                                    <h3 th:text="${'@'+usuario.getUsername}" class="title"></h3>
                                                    <h4 th:text="${'@'+usuario.getNickname}" class="title"></h4>
                                                    <h5 th:text="${usuario.getDescricaoPerfil}" class="card-description"></h5>

                                                    <!--verificar se perfil pertence ao usuario-->
                                                    <div th:if="${principalUser != usuario}">
                                                        <a class="btn btn-secondary btn-sm" href="">Doar Bc</a>

                                                        <!--botao de alt amizade-->
                                                        <form id="formPerfil" action="/perfil/altAmizade" method="GET">
                                                            <input type="hidden" name="username" th:value="${usuario.getUsername}">
                                                            <button id="btnSeguir" type="submit" class="btn btn-primary">
                                                                <span id="textoSeguir"
                                                                      th:text="${principalUser.friendWith(usuario)} ? 'Desconectar' : 'Conectar'"></span>
                                                            </button>
                                                        </form>

                                                        <a class="btn btn-secondary btn-sm" href="">Chat</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!--nav secundario-->
                                        <!--Postagens do usuario dentro do perfil (for)-->
                                        <div class="tab-pane" id="posts2">

                                            <!--Formulario para adicionar nova postagem em perfil-->
                                            <br/>
                                            <div th:if="${principalUser == usuario}">
                                                <form  action="/principalUser/addPostagem" method="post" class="mx-auto" enctype="multipart/form-data">
                                                    <!-- Button trigger modal -->
                                                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalPost">
                                                        Adicionar Nova Postagem
                                                    </button>

                                                    <!-- Modal -->
                                                    <div class="modal fade" id="modalPost" tabindex="-1" role="dialog"
                                                         aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLongTitle">Criar Postagem</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <!--inputs-->
                                                                <div class="modal-body">
                                                                <span class="bmd-form-group">
                                                                    <div class="input-group">
                                                                        <div class="input-group-prepend">
                                                                            <span class="input-group-text">
                                                                                <i class="material-icons">article</i>
                                                                            </span>
                                                                        </div>
                                                                        <input type="text" class="form-control"
                                                                               name="descricao" placeholder="Texto Postagem" autocomplete="none">
                                                                    </div>
                                                                </span>
                                                                    <span class="bmd-form-group">
                                                                    <div class="input-group">
                                                                        <div class="input-group-prepend">
                                                                            <span class="input-group-text">
                                                                                <i class="material-icons">collections</i>
                                                                            </span>
                                                                        </div>
                                                                        <input type="file" class="form-control" name="file"
                                                                               placeholder="Foto" autocomplete="none" accept="image/png/jpg/jpeg/jfif">
                                                                    </div>
                                                                </span>
                                                                </div>
                                                                <!--footer modal-->
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                                                                    <button type="submit" class="btn btn-primary">Salvar</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <br/>

                                            <!--postagens-->
                                            <div class="container row mx-auto">
                                                <div th:each="post : ${usuario.getPostagens}"
                                                     class="card col-md-4 col-sm-6 padding-top-1">
                                                    <!--img-->
                                                    <div class="container-img click" data-toggle="modal" th:data-target="${'#detalhesPostagem'+post.getId}">
                                                        <img th:if="${post.getImagemPost != null}"
                                                             class="card-img-top" th:src="${'/provedor/postImg/'+post.getId}"
                                                             rel="nofollow" alt="Deu erro na hora de carregar meu chapa :p">
                                                    </div>
                                                    <!--descricao-->
                                                    <div class="card-body">
                                                        <h4 class="card-title"></h4>
                                                        <p th:text="${post.getDescricao}" class="card-text"></p>
                                                        <p class="card-text"><small th:text="${post.getDataPostagem}"
                                                                                    class="text-muted"></small></p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Modal Postagem completa-->
                                            <div th:each="post : ${usuario.getPostagens}">
                                                <div class="modal fade" th:id="${'detalhesPostagem'+post.getId}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <!--header modal-->
                                                            <div class="modal-header">
                                                                <h5 th:text="${post.getDescricao}" class="modal-title" id="exampleModalLabel"></h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">×</span>
                                                                </button>
                                                            </div>
                                                            <!--body modal-->
                                                            <div class="modal-body container-img-comport">
                                                                <img th:if="${post.getImagemPost != null}"
                                                                     th:src="${'/provedor/postImg/'+post.getId}"
                                                                     rel="nofollow" alt="Deu erro na hora de carregar a foto meu chapa :p">
                                                            </div>
                                                            <!--footer modal-->
                                                            <div class="modal-footer">
                                                                <span th:text="${post.getDataPostagem}"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--Amigos do usuario dentro do perfil ( for)-->
                                        <div class="tab-pane" id="amigos2">
                                            <div class="container row mx-auto">
                                                <a th:each="amigo : ${usuario.ListAmigosUsuarios}"
                                                   th:href="${'/perfil/'+amigo.getUsername}" class="col-md-4 col-sm-6">
                                                    <h4 th:text="${'@'+amigo.getNickname}"></h4>
                                                    <img th:src="${'/provedor/nickImg/'+amigo.getUsername}"
                                                         alt="Raised Image" class="img-raised rounded img-fluid"/>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--preferencias do usuario-->
                        <div class="tab-pane" id="pref">
                            <div class="container row justify-md-center col-md-8 mx-auto">

                                <span class="badge badge-info" style="margin-left: 10px; margin-top: 10px;">Cores Favoritas -->></span>

                                <span th:each="cor : ${usuario.getCoresFavoritas}"
                                      th:class="${principalUser.containsCorFav(cor)} ? ('badge badge-success') : ('badge badge-danger')"
                                      th:text="${cor}" style="margin-left: 10px; margin-top: 10px;">
                                </span>

                                <span class="badge badge-info" style="margin-left: 10px; margin-top: 10px;">Estilos Musicais Favoritos -->></span>

                                <span th:each="musica : ${usuario.estiloMusical}"
                                      th:class="${principalUser.containsMscFav(musica)} ? ('badge badge-success') : ('badge badge-danger')"
                                      th:text="${musica}" style="margin-left: 10px; margin-top: 10px;">
                                </span>

                                <span class="badge badge-info" style="margin-left: 10px; margin-top: 10px;">Animais Favoritos -->></span>

                                <span th:each="animal : ${usuario.animaisFavoritos}"
                                      th:class="${principalUser.containsAnmFav(animal)} ? ('badge badge-success') : ('badge badge-danger')"
                                      th:text="${animal}" style="margin-left: 10px; margin-top: 10px;">
                                </span>
                            </div>
                        </div>

                        <!--chats do usuario-->
                        <div class="tab-pane" id="bubble">

                        </div>
                    </div>
                </div>
            </div>
        </main>
        <footer th:replace="replace/base :: footer"></footer>
        <div th:replace="replace/base :: js"></div>
    </body>
</html>